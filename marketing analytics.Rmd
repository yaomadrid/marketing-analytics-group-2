url: https://github.com/yaomadrid/marketing-analytics-group-2.git
title: "Marketing Analytics"
output: word_document

1. What is the data problem? What is the final managerial objective?

Our dataset covers all mortgage information in 2015 for the state of New York, provided by financial institutions. These information were required by Home Mortgage Disclosure Act (HMDA), which unveils all information of mortgage decisions and helps public to make loan decisions. Our final managerial objective is to find out the factors that influence the approval of mortgage and predict mortgage decision based on our model. 

```{r }

```

2.Describe the measurement types of each variable




```{r}
summary(car)
1111
```

3. Create a table summarizing the range or variation in each variable. Add statistics (mean,
median, standard deviation, etc.) as you deem necessary.

                                       
```{r}


```


4. How do you handle missing data in this dataset?
```{r}

```


5. Provide histograms/density plots for key variables, such as action taken on loan, gender,
ethnicity, etc.
```{r pressure, echo=FALSE}
plot(pressure)
```

Action in Loans

```{r}
library(dplyr)
ny_hmda_possessed = ny_hmda %>%
group_by(action_taken_name) %>%
summarize(TotalActionTaken = n()) %>%
mutate(PercentageActionTaken = TotalActionTaken/sum(TotalActionTaken) * 100)
library(ggplot2)
ggplot(ny_hmda_possessed, aes(x = action_taken_name,y = PercentageActionTaken))+ geom_bar(stat='identity',colour="white")+labs( title = 'Actions in Loans')+theme(axis.text.x = element_text(angle = 30, hjust = 1))

```



Hustogram of Income
```{r}
library(dplyr)
ny_hmdaIncome <-ny_hmda %>%
  filter(!is.na(hud_median_family_income)) 
plot(density(ny_hmdaIncome$hud_median_family_income), main = "Histogram of income", 
    xlab = "Income", ylab = "Count (#)")
```

Minority_population distribution
```{r}
library(dplyr)
ny_hm_minority_population <-ny_hmda %>%
  filter(!is.na(minority_population)) 
plot(density(ny_hm_minority_population$minority_population), main = "Minority_population", 
     xlab = "Minority", ylab = "Count (#)")

```

```{r}
ny_hmdaSex= ny_hmda %>%
  filter(applicant_sex < 3) %>%
  group_by(applicant_sex_name) %>%
  summarize(TotalActionTaken = n()) %>%
  mutate(PercentageActionTaken = TotalActionTaken/sum(TotalActionTaken) * 100)
library(ggplot2)
ggplot(ny_hmdaSex, aes(x = applicant_sex_name ,y = PercentageActionTaken))+ geom_bar(stat='identity',colour="red")+labs( title = 'Actions in Loans')



```

Action in Loans by Race
```{r}
ny_hmdaRace= ny_hmda %>%
  filter(applicant_race_1 < 7 )%>%
  group_by(applicant_race_name_1) %>%
  summarize(TotalActionTaken = n()) %>%
  mutate(PercentageActionTaken = TotalActionTaken/sum(TotalActionTaken) * 100)
ny_hmdaRace 
library(ggplot2)
ggplot(ny_hmdaRace, aes(x = applicant_race_name_1,(angle=30) ,y = PercentageActionTaken))+ geom_bar(stat='identity',colour="red")+labs( title = 'Actions in Loans by race')+theme(axis.text.x = element_text(angle = 30, hjust = 1))

```

Preapproval
```{r}
ny_hmda_preapproval= ny_hmda %>%
group_by(preapproval_name) %>%
summarize(TotalActionTaken = n()) %>%
mutate(PercentageActionTaken = TotalActionTaken/sum(TotalActionTaken) * 100)
homeMortgage_preapproval
ggplot(ny_hmda_preapproval, aes(x = preapproval_name,y = PercentageActionTaken))+ geom_bar(stat='identity',colour="blue")+labs( title = 'Percentage of Loans by Preapproval')+theme(axis.text.x = element_text(angle = 30, hjust = 1))

```


Owner Occupancy Graph
```{r}
ny_hmda_occupancy= ny_hmda %>%
    group_by(owner_occupancy_name) %>%
    summarize(TotalActionTaken = n()) %>%
    mutate(PercentageActionTaken = TotalActionTaken/sum(TotalActionTaken) * 100)
homeMortgage_race
library(ggplot2)
ggplot(ny_hmda_occupancy, aes(x = owner_occupancy_name,(angle=30) ,y = PercentageActionTaken))+ geom_bar(stat='identity',colour="blue")+labs( title = 'Percentage of Loans by Owner Occupancy')+theme(axis.text.x = element_text(angle = 30, hjust = 1))
```

Lien Status
```{r}
ny_hmda_lien = ny_hmda %>% 
  group_by(lien_status_name) %>%
  summarise(CountOfLien = n()) %>%
  arrange(desc(CountOfLien))

ggplot(ny_hmda_lien, aes(x = reorder(lien_status_name, CountOfLien), 
                              y = CountOfLien)) +
  geom_bar(stat='identity',colour="white", fill =fillColor2) +
  geom_text(aes(x = lien_status_name, y = 1, label = paste0("(",round(CountOfLien),")",sep="")),
            hjust=0, vjust=.5, size = 4, colour = 'black',
            fontface = 'bold') +
  labs(x = 'Lien Status Name', y = '%age Count Of Action Taken', title = 'Actions in Loans') +
  coord_flip() + 
  theme_bw()
```

loan purpose
```{r}
ny_hmda_purpose= ny_hmda %>% 
  group_by(loan_purpose_name) %>%
  summarise(CountOfLoanPurpose = n()) %>%
  arrange(desc(CountOfLoanPurpose))

ggplot(ny_hmda_purpose, aes(x = reorder(loan_purpose_name, CountOfLoanPurpose), 
                                     y = CountOfLoanPurpose)) +
  geom_bar(stat='identity',colour="white", fill =fillColor2) +
  geom_text(aes(x = loan_purpose_name, y = 1, label = paste0("(",round(CountOfLoanPurpose),")",sep="")),
            hjust=0, vjust=.5, size = 4, colour = 'black',
            fontface = 'bold') +
  labs(x = 'loan_purpose_name', y = '%age Count Of Action Taken', title = 'Actions in Loans') +
  coord_flip() + 
  theme_bw()

```


Loan Types
```{r}
ny_hmda_type= ny_hmda %>%
filter(!is.na(loan_type_name)) %>%
  group_by() %>%
  summarize(TotalActionTaken = n()) %>%
  mutate(PercentageActionTaken = TotalActionTaken/sum(TotalActionTaken) * 100)
ggplot(ny_hmda_preapproval, aes(x = preapproval_name,y = PercentageActionTaken))+ geom_bar(stat='identity',colour="blue")+labs( title = 'Percentage of Loans by Preapproval')+theme(axis.text.x = element_text(angle = 30, hjust = 1))

```
6. Create bivariate frequency distributions (tables or plots) for key variables. 

Lean_status distribution by actions

```{r}
ny_hmdaLean_status=ny_hmda %>%
group_by(lien_status_name, action_taken_name) %>%
summarize(TotalActionTaken = n()) 
ny_hmdaLean_status
ggplot(ny_hmdaLean_status, aes(x = action_taken_name,y = TotalActionTaken))+ geom_bar(stat='identity',colour="red")+labs( title = 'lean_status distribution by actions')+facet_wrap(~ lien_status_name, scales ="free_y")+theme(axis.text.x = element_text(angle = 30, hjust = 1))
              
```

Loans Purpose Types Distribution with Race

```{r}
ny_hmdaRace_status=ny_hmda %>%
  filter(applicant_race_1 < 7 )%>%
  group_by(applicant_race_name_1, action_taken_name) %>%
  summarize(TotalActionTaken = n()) 
ny_hmdaRace_status
ggplot(ny_hmdaRace_status, aes(x = action_taken_name,y = TotalActionTaken))+ geom_bar(stat='identity',colour="red")+labs( title = ' race destribution by loan actions')+ facet_wrap(~ applicant_race_name_1 , scales ="free_y")+ theme(axis.text.x = element_text(angle = 30, hjust = 1))



```

Loans Purpose Types Distribution with Action Types

```{r }
  ny_hmda %>%
  filter(!is.na(loan_purpose_name)) %>%
  group_by(loan_purpose_name,action_taken_name) %>%
  summarise(CountLoanPurpose = n() ) %>%
  ggplot(aes(x = action_taken_name,y = CountLoanPurpose,fill =(loan_purpose_name))) +
  geom_bar(stat='identity',colour="white") +
  labs(x = 'Loan Purpose', y = 'Count', title = 'Loans Purpose Types Distribution with Action Types') +
  theme_bw()+theme(axis.text.x = element_text(angle = 30, hjust = 1))
```

Relationship between Applicant Income level and Action of Loans

```{r }
ny_hmda_income =  ny_hmda %>%
filter(!is.na(applicant_income_000s)) 
ny_hmda_income$Income.Level = "0"
ny_hmda_income[ny_hmda_income$applicant_income_000s <= 60,]$Income.Level = "Level1"
ny_hmda_income[ny_hmda_income$applicant_income_000s > 60 & ny_hmda_income$applicant_income_000s <=90,]$Income.Level = "Level2"
ny_hmda_income[ny_hmda_income$applicant_income_000s > 90 & ny_hmda_income$applicant_income_000s <=150,]$Income.Level = "Level3"
ny_hmda_income[ny_hmda_income$applicant_income_000s > 150,]$Income.Level = "Level4"
table(ny_hmda_income$action_taken_name,ny_hmda_income$Income.Level)
```
```{r}
summary(car)
1111
```
7. Discuss what the data patterns indicate, and what this could mean for the probability of
getting a loan approved.

